{"timestamp":"1667664132","reviewRef":"refs/pull/458/head","targetRef":"refs/heads/main","requester":"riidefi","description":"Reset Mirror-Mode BRRES patches on reload\n\nIn Mirror Mode, to reflect the track across a plane, the game applies a negative scale along an axis to each model's matrix. However, this has an unintended consequence: it turns each model inside-out (much like how 2D reflection--flipping a paper upside down--reveals the back-side of a figure). This is problematic, as the GPU usually only renders the front face of a triangle as an optimization (\"culling\" the back face). To accommodate this, when a track is loaded as Mirror, the game inverts each material's \"cull mode\"; this instructs the GPU to cull front faces, keeping back faces. This is preferable to simply disabling culling altogether, as that would burden the GPU with additional processing load each frame.\r\n\r\nThis PR introduces logic to detect when a material has been patched, and revert the patch. Covering most models in a scene, this logic has been attached to Render::DrawMdl's destructor. However, this does not cover the changes made to character models.\r\n\r\nUnblocks #402, though additional care must be taken to call `DrawMdl::revertMirrorPatches` and `DrawMdl::applyMirrorPatches` on driver models when necessary."}
