{"timestamp":"1685849313","author":"riidefi","description":"Would it make more sense to use the arrays in `GlobalContext`? Or if we want, extend `GlobalContext` with a new array?\r\n| Offset | Name |\r\n|--------|--------|\r\n| GlobalContext+0x78   |  u32 mTrackOrder[32]; | \r\n| GlobalContext+0xF8   |  u32 mTrackOrderLen; | \r\n| GlobalContext+0xFC | u32 mBattleOrder[10]; |\r\n\r\n| Address | Name |\r\n|----------|--------|\r\n| 808606A4 | GlobalContext_getCourseMatch(u32 index) |\r\n| 808606D0 | GlobalContext_getBattleMatch(u32 index) |\r\n\r\nI think the idea would be to keep the course order in `GlobalContext` and let `RaceConfig` stay a mostly dumb POD mostly concerned with the current race?\r\n\r\nIt seems a bit weird to have `RaceConfig` encroach on `GlobalContext`'s duties like this?\r\n"}

{"timestamp":"1685882199","author":"GnomedDev","description":"No, because of the reasons I said in the dev channel before you commented that.\r\n"}

{"timestamp":"1687201161","author":"riidefi","description":"LGTM! I didn't realize we still had SectionManager.c around to complicate things"}

{"timestamp":"1687203492","author":"GnomedDev","description":"Yeah, I was able to very much stub it, but we still need that old-style patch for the GlobalContext allocation."}

{"timestamp":"1688587913","author":"GnomedDev","description":"Fixed merge conflicts."}

{"timestamp":"1685649869","author":"stblr","location":{"commit":"e2935bd5e2de3f54c5fd51b8abe7f388efbd5949","path":"payload/game/system/RaceConfig.cc","range":{"startLine":154}},"description":"How is the title screen demo handled?"}

{"timestamp":"1685650009","author":"stblr","location":{"commit":"e2935bd5e2de3f54c5fd51b8abe7f388efbd5949","path":"payload/game/system/RaceConfig.cc","range":{"startLine":248}},"description":"What happens if `raceCount` is larger than `courseCount`?"}

{"timestamp":"1685650382","author":"riidefi","location":{"commit":"e2935bd5e2de3f54c5fd51b8abe7f388efbd5949","path":"payload/sp/CircularBuffer.hh","range":{"startLine":71}},"description":"```diff\r\n- bool contains(T needle) {\r\n+ bool contains(const T \u0026needle) {`\r\n```"}

{"timestamp":"1685650435","author":"riidefi","location":{"commit":"e2935bd5e2de3f54c5fd51b8abe7f388efbd5949","path":"payload/game/system/GhostFile.cc","range":{"startLine":263}},"description":"Move to `CourseIdIsValid`"}

{"timestamp":"1685650462","author":"stblr","location":{"commit":"e2935bd5e2de3f54c5fd51b8abe7f388efbd5949","path":"payload/game/ui/SingleTopPage.cc","range":{"startLine":90}},"description":"What about `MultiTopPage`?"}

{"timestamp":"1685650496","author":"riidefi","location":{"commit":"e2935bd5e2de3f54c5fd51b8abe7f388efbd5949","path":"payload/game/system/RaceConfig.cc","range":{"startLine":236}},"description":"{.battle = ..., .race = ... };"}

{"timestamp":"1685650514","author":"riidefi","location":{"commit":"e2935bd5e2de3f54c5fd51b8abe7f388efbd5949","path":"payload/game/system/RaceConfig.cc","range":{"startLine":263}},"description":"ditto"}

{"timestamp":"1685655910","author":"GnomedDev","location":{"commit":"e2935bd5e2de3f54c5fd51b8abe7f388efbd5949","path":"payload/game/system/GhostFile.cc","range":{"startLine":263}},"description":"uh, do you want me to create a new function for that static_cast or do some extra checks, because extra checks sounds out of scope."}

{"timestamp":"1685656240","author":"riidefi","location":{"commit":"e2935bd5e2de3f54c5fd51b8abe7f388efbd5949","path":"payload/game/system/GhostFile.cc","range":{"startLine":263}},"description":"Do something similar to what hnery did, with a switch case CRS_0 ... CRS_32 essentially"}

{"timestamp":"1685656287","author":"GnomedDev","location":{"commit":"e2935bd5e2de3f54c5fd51b8abe7f388efbd5949","path":"payload/game/system/GhostFile.cc","range":{"startLine":263}},"description":"Out of scope for this PR then."}

{"timestamp":"1685656414","author":"riidefi","location":{"commit":"e2935bd5e2de3f54c5fd51b8abe7f388efbd5949","path":"payload/game/system/GhostFile.cc","range":{"startLine":263}},"description":"Retyping `courseId` to an enum would be the out-of-scope change, if any. Notwithstanding, if you want to make that change in this PR, it should be done correctly."}

{"timestamp":"1685656599","author":"GnomedDev","location":{"commit":"e2935bd5e2de3f54c5fd51b8abe7f388efbd5949","path":"payload/game/system/GhostFile.cc","range":{"startLine":263}},"description":"I know it is somewhat out of scope now I've finished it, but started off as a small change to improve type safety. I can split it off into a separate PR if you want, but I don't think we should be making a passable situation worse by adding entirely new validity checking logic. "}

{"timestamp":"1685656914","author":"riidefi","location":{"commit":"e2935bd5e2de3f54c5fd51b8abe7f388efbd5949","path":"payload/game/system/GhostFile.cc","range":{"startLine":263}},"description":"I would add this to Registry.cc\r\n```cpp\r\nbool IsControllerValid(Controller controller) {\r\n    switch (controller) {\r\n    case Controller::WiiWheel... Controller::GameCube:\r\n        return true;\r\n    default:\r\n        return false;\r\n    }\r\n}\r\n```\r\nI would expect something like this in any PR that has retyping courseId as a goal"}

{"timestamp":"1685657296","author":"GnomedDev","location":{"commit":"e2935bd5e2de3f54c5fd51b8abe7f388efbd5949","path":"payload/game/system/RaceConfig.cc","range":{"startLine":154}},"description":"Good catch, seems like in testing it always does Luigi's circuit, I'll see how to fix."}

{"timestamp":"1685658550","author":"GnomedDev","location":{"commit":"e2935bd5e2de3f54c5fd51b8abe7f388efbd5949","path":"payload/game/system/RaceConfig.cc","range":{"startLine":248}},"description":"Currently it would infinite loop here, how does the base game handle it?"}

{"timestamp":"1685661510","author":"GnomedDev","location":{"commit":"e2935bd5e2de3f54c5fd51b8abe7f388efbd5949","path":"payload/game/system/RaceConfig.cc","range":{"startLine":248}},"description":"Looks like the base game doesn't handle this, for battle it generates 10 courses and for race it generates 32 courses."}

{"timestamp":"1685820835","author":"stblr","location":{"commit":"abe07dda494ff3f52c3407b51ef37d077311c0ac","path":"payload/game/ui/CourseSelectPage.cc","range":{"startLine":139}},"description":"This won't be called if course selection is randomized."}

{"timestamp":"1685826704","author":"GnomedDev","location":{"commit":"abe07dda494ff3f52c3407b51ef37d077311c0ac","path":"payload/game/ui/CourseSelectPage.cc","range":{"startLine":139}},"description":"It will if it's ordered."}

{"timestamp":"1687909332","author":"GnomedDev","location":{"commit":"abe07dda494ff3f52c3407b51ef37d077311c0ac","path":"payload/game/ui/CourseSelectPage.cc","range":{"startLine":139}},"description":"Fixed this, after remembering about the discussion on discord."}
